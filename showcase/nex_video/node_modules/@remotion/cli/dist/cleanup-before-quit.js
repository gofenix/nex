"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handleCtrlC = exports.registerCleanupJob = exports.cleanupBeforeQuit = void 0;
const log_1 = require("./log");
const cleanupJobs = [];
const cleanupBeforeQuit = () => {
    log_1.Log.verbose('Cleaning up...');
    const time = Date.now();
    for (const job of cleanupJobs) {
        job();
    }
    log_1.Log.verbose(`Cleanup done in ${Date.now() - time}ms`);
};
exports.cleanupBeforeQuit = cleanupBeforeQuit;
const registerCleanupJob = (job) => {
    cleanupJobs.push(job);
};
exports.registerCleanupJob = registerCleanupJob;
const handleCtrlC = () => {
    process.on('SIGINT', () => {
        log_1.Log.info();
        (0, exports.cleanupBeforeQuit)();
        process.exit(0);
    });
};
exports.handleCtrlC = handleCtrlC;
