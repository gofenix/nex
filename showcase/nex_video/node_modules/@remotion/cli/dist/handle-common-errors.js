"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handleCommonError = void 0;
const chalk_1 = require("./chalk");
const log_1 = require("./log");
const print_error_1 = require("./print-error");
const truthy_1 = require("./truthy");
const handleCommonError = async (err, logLevel) => {
    var _a;
    await (0, print_error_1.printError)(err, logLevel);
    if (err.message.includes('Could not play video with')) {
        log_1.Log.info();
        log_1.Log.info('ðŸ’¡ Get help for this issue at https://remotion.dev/docs/media-playback-error');
    }
    if (err.message.includes('A delayRender()') &&
        err.message.includes('was called but not cleared after')) {
        log_1.Log.info();
        log_1.Log.info('ðŸ’¡ Get help for this issue at https://remotion.dev/docs/timeout');
    }
    if (err.message.includes('Target closed')) {
        log_1.Log.info();
        log_1.Log.info('ðŸ’¡ Get help for this issue at https://remotion.dev/docs/target-closed');
    }
    if (err.message.includes('ENAMETOOLONG')) {
        log_1.Log.info();
        log_1.Log.info('ðŸ’¡ Get help for this issue at https://remotion.dev/docs/enametoolong');
    }
    if (err.message.includes('Error creating WebGL context')) {
        log_1.Log.info();
        log_1.Log.info('ðŸ’¡ You might need to set the OpenGL renderer to "angle"');
        log_1.Log.info('ðŸ’¡ Get help for this issue at https://www.remotion.dev/docs/three');
    }
    if (err.message.includes('The bucket does not allow ACLs')) {
        log_1.Log.info();
        log_1.Log.info(chalk_1.chalk.green('ðŸ’¡ Fix this issue https://remotion.dev/docs/lambda/troubleshooting/bucket-disallows-acl'));
    }
    if (err.message.includes('Minified React error #306')) {
        const componentName = (_a = err.message.match(/<\w+>/)) === null || _a === void 0 ? void 0 : _a[0];
        log_1.Log.info([
            'ðŸ’¡ This error indicates that the component',
            componentName ? `(${componentName})` : null,
            'you are trying to render is not imported correctly.',
        ]
            .filter(truthy_1.truthy)
            .join(' '));
        log_1.Log.info();
        log_1.Log.info('   Check the root file and ensure that the component is not undefined.');
        log_1.Log.info('   Oftentimes, this happens if the component is missing the `export` keyword');
        log_1.Log.info('   or if the component was renamed and the import statement not properly adjusted.');
    }
    if (err.message.includes('GLIBC_')) {
        log_1.Log.info('ðŸ’¡ Remotion requires at least Libc 2.34.');
        log_1.Log.info('ðŸ’¡ Get help for this issue: https://github.com/remotion-dev/remotion/issues/2439');
    }
    if (err.message.includes('EBADF')) {
        log_1.Log.info('ðŸ’¡ This error might be fixed by changing your Node version:');
        log_1.Log.info('   https://github.com/remotion-dev/remotion/issues/2452');
    }
};
exports.handleCommonError = handleCommonError;
